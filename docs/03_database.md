# 03. データベース設計

## MCP × Google Maps AIナビ PoC

---

## 1. 判断: データベース不要

本PoCではデータベースを使用しない。

---

## 2. 判断根拠

### 2.1 PoCの性質

本プロジェクトは「AIナビの判断構造」を検証する思想検証PoCであり、以下の特性を持つ。

- **ステートレス**: 各ナビリクエストは独立しており、前回の検索結果に依存しない
- **データ永続化不要**: ルート検索結果は使い捨て（表示したら終わり）
- **ユーザー管理不要**: 認証・アカウント機能は非スコープ
- **履歴保存不要**: 走行履歴・検索履歴の蓄積はPoC範囲外

### 2.2 データのライフサイクル

```
リクエスト受信 → Claude判断 → API呼出 → レスポンス返却 → 破棄
```

全てのデータはリクエスト〜レスポンスの間だけメモリ上に存在し、処理完了後に破棄される。

### 2.3 代替手段

| データ種別 | 保持場所 | 寿命 |
|---|---|---|
| ナビリクエスト | リクエストボディ（メモリ） | リクエスト処理中のみ |
| Claude会話履歴 | フロントエンドstate（React） | ブラウザセッション中 |
| ルート検索結果 | レスポンスJSON（メモリ） | レスポンス返却まで |
| 地図表示状態 | フロントエンドstate（Leaflet） | ブラウザセッション中 |
| APIキー | 環境変数（.env） | サーバー起動中 |

---

## 3. 将来拡張時のDB導入判断

PoCから次フェーズに進む場合、以下の機能追加時にDB導入を検討する。

| 追加機能 | DB候補 | 理由 |
|---|---|---|
| 検索履歴の保存 | SQLite / PostgreSQL | ユーザーごとの過去ルート参照 |
| ユーザー管理 | PostgreSQL | 認証・プロフィール管理 |
| ルートお気に入り | PostgreSQL | 永続的なルート保存 |
| 利用量トラッキング | PostgreSQL / Redis | APIコスト管理 |
| 会話履歴永続化 | PostgreSQL + Redis | 長期的なコンテキスト保持 |

導入時は Railway の PostgreSQL アドオンまたは Supabase を想定。

---

## 4. 結論

PoCフェーズではDB導入のコスト（設計・マイグレーション・運用）に対してリターンがなく、アーキテクチャの複雑性を不要に増加させるため、**意図的に除外する**。これはPoC目的（AI判断構造の検証）と整合している。
